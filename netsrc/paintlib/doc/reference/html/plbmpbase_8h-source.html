<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>paintlib: plbmpbase.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>plbmpbase.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">/--------------------------------------------------------------------</span>
00003 <span class="comment">|</span>
00004 <span class="comment">|      $Id: plbmpbase_8h-source.html,v 1.2 2004/09/15 15:26:29 uzadow Exp $</span>
00005 <span class="comment">|</span>
00006 <span class="comment">|      Copyright (c) 1996-2002 Ulrich von Zadow</span>
00007 <span class="comment">|</span>
00008 <span class="comment">\--------------------------------------------------------------------</span>
00009 <span class="comment">*/</span>
00010 
00011 <span class="preprocessor">#ifndef INCL_PLBMPBASE</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define INCL_PLBMPBASE</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include "plbmpinfo.h"</span>
00015 <span class="preprocessor">#include "plpoint.h"</span>
00016 <span class="preprocessor">#include "pldebug.h"</span>
00017 <span class="preprocessor">#include "plpixel32.h"</span>
00018 <span class="preprocessor">#include "plpixel24.h"</span>
00019 <span class="preprocessor">#include "plpixel16.h"</span>
00020 
00021 <span class="keyword">class </span><a class="code" href="classPLFilter.html">PLFilter</a>;
00022 <span class="comment"></span>
00023 <span class="comment">//! Base class for PLBmp and PLSubBmp. PLBmpBase supports all operations</span>
00024 <span class="comment">//! on a bitmap that PLBmp supports except those that depend on being able</span>
00025 <span class="comment">//! to change the size or bpp.</span>
<a name="l00026"></a><a class="code" href="classPLBmpBase.html">00026</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classPLBmpBase.html">PLBmpBase</a> : <span class="keyword">public</span> <a class="code" href="classPLBmpInfo.html">PLBmpInfo</a>
00027 {
00028 
00029 <span class="keyword">public</span>:
00030 <span class="comment"></span>
00031 <span class="comment">  //! Empty constructor. </span>
00032 <span class="comment"></span>  <a class="code" href="classPLBmpBase.html">PLBmpBase</a>
00033     ();
00034 <span class="comment"></span>
00035 <span class="comment">  //! Empty destructor.</span>
00036 <span class="comment"></span>  <span class="keyword">virtual</span> ~<a class="code" href="classPLBmpBase.html">PLBmpBase</a>
00037     ();
00038 <span class="comment"></span>
00039 <span class="comment">  //! Test for equality. This function actually tests every pixel, so</span>
00040 <span class="comment">  //! it's not fast. It's meant mainly for use in asserts and such.</span>
00041 <span class="comment"></span>  <span class="keywordtype">bool</span> <span class="keyword">const</span> <span class="keyword">operator</span> ==
00042     ( <a class="code" href="classPLBmpBase.html">PLBmpBase</a> <span class="keyword">const</span> &amp;Other
00043     );
00044 
00045 <span class="preprocessor">#ifdef _DEBUG</span>
00046 <span class="preprocessor"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> AssertValid
00047     () <span class="keyword">const</span>;    <span class="comment">// Tests internal object state</span>
00048 <span class="preprocessor">#endif</span>
00049 <span class="preprocessor"></span>
00050   <span class="comment">// PLBmpBase manipulation</span>
00051 <span class="comment"></span>
00052 <span class="comment">  //! BitBlts SrcBmp on the current bitmap. Color depth conversion is </span>
00053 <span class="comment">  //! performed as nessesary.</span>
00054 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a3">CopyPixels</a>
00055     ( <span class="keyword">const</span> <a class="code" href="classPLBmpBase.html">PLBmpBase</a>&amp; SrcBmp
00056     );
00057 <span class="comment"></span>
00058 <span class="comment">  //! Fills the color table with a grayscale palette. This function</span>
00059 <span class="comment">  //! is only usable for bitmaps containing a color table. Index 0</span>
00060 <span class="comment">  //! contains black (0) and the last index contains white (255). The</span>
00061 <span class="comment">  //! alpha channel is set to opaque (255) for every palette entry.</span>
00062 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a4">SetGrayPalette</a>
00063     ();
00064 <span class="comment"></span>
00065 <span class="comment">  //! Sets the color table to pPal. The contents of pPal are copied.</span>
00066 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a5">SetPalette</a>
00067     ( <a class="code" href="classPLPixel32.html">PLPixel32</a> * pPal
00068     );
00069 <span class="comment"></span>
00070 <span class="comment">  //! Sets one entry in the color table. The function may only be</span>
00071 <span class="comment">  //! called if there is a color table stored with the bitmap. The</span>
00072 <span class="comment">  //! color table entry is set to the red, green, blue, and alpha</span>
00073 <span class="comment">  //! values specified.</span>
00074 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a6">SetPaletteEntry</a>
00075     ( PLBYTE Entry,
00076       PLBYTE r,
00077       PLBYTE g,
00078       PLBYTE b,
00079       PLBYTE a
00080     );
00081 <span class="comment"></span>
00082 <span class="comment">  //! Sets one entry in the color table. The function may only be</span>
00083 <span class="comment">  //! called if there is a color table stored with the bitmap. The</span>
00084 <span class="comment">  //! color table entry is set to the red, green, blue, and alpha</span>
00085 <span class="comment">  //! values specified.</span>
00086 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a6">SetPaletteEntry</a>
00087     ( PLBYTE Entry,
00088       <a class="code" href="classPLPixel32.html">PLPixel32</a> Value
00089     );
00090 <span class="comment"></span>
00091 <span class="comment">  //! Sets whether a bitmap stores an alpha channel. Works for 8 and 32 bpp </span>
00092 <span class="comment">  //! bitmaps. In either case, if b is true and the bitmap did not have an </span>
00093 <span class="comment">  //! alpha channel before the call, the complete alpha channel is set to</span>
00094 <span class="comment">  //! opaque by the call.</span>
00095 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a8">SetHasAlpha</a>
00096     (<span class="keywordtype">bool</span> b
00097     );
00098 <span class="comment"></span>
00099 <span class="comment">  //! Replaces the alpha channel of the bitmap with a new one. This</span>
00100 <span class="comment">  //! only works for bitmaps with 32 bpp. pAlphaBmp must point to an</span>
00101 <span class="comment">  //! 8 bpp bitmap with the same dimensions as the object. The alpha</span>
00102 <span class="comment">  //! channel information is physically copied into the bitmap.</span>
00103 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a9">SetAlphaChannel</a>
00104     ( <a class="code" href="classPLBmpBase.html">PLBmpBase</a> * pAlphaBmp
00105     );
00106 <span class="comment"></span>
00107 <span class="comment">  //! Slow but simple function to set a single pixel. 32 bpp only.</span>
00108 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a10">SetPixel</a>
00109     ( <span class="keywordtype">int</span> x,
00110       <span class="keywordtype">int</span> y,
00111       <a class="code" href="classPLPixel32.html">PLPixel32</a> pixel
00112     );
00113 <span class="comment"></span>
00114 <span class="comment">  //! Slow but simple function to get a single pixel. 32 bpp only.</span>
00115 <span class="comment"></span>  <a class="code" href="classPLPixel32.html">PLPixel32</a> <a class="code" href="classPLBmpBase.html#a11">GetPixel</a>
00116     ( <span class="keywordtype">int</span> x,
00117       <span class="keywordtype">int</span> y
00118     ) <span class="keyword">const</span>;
00119 <span class="comment"></span>
00120 <span class="comment">  //! Find the nearest color to cr in the palette used by this bitmap</span>
00121 <span class="comment">  //! Only works for 8 bpp bitmaps.</span>
00122 <span class="comment"></span>  PLBYTE <a class="code" href="classPLBmpBase.html#a12">FindNearestColor</a>
00123     ( <a class="code" href="classPLPixel32.html">PLPixel32</a> cr
00124     );
00125 
00126   <span class="comment">// PLBmpBase information.</span>
00127 <span class="comment"></span>
00128 <span class="comment">  //! Returns number of colors that can be stored by a bitmap with this</span>
00129 <span class="comment">  //! color depth.</span>
00130 <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classPLBmpBase.html#a13">GetNumColors</a>
00131     ();
00132 
00133   <span class="comment">// PLBmpBase direct manipulation</span>
00134 <span class="comment"></span>
00135 <span class="comment">  //! Returns the address of the color table of the bitmap or NULL if</span>
00136 <span class="comment">  //! no color table exists. The color table is stored as an array of</span>
00137 <span class="comment">  //! consecutive PLPixel32 objects.</span>
00138 <span class="comment"></span>  <a class="code" href="classPLPixel32.html">PLPixel32</a> * <a class="code" href="classPLBmpBase.html#a14">GetPalette</a>
00139     () <span class="keyword">const</span>;
00140 <span class="comment"></span>
00141 <span class="comment">  //! Returns pointer to an array containing the starting addresses of</span>
00142 <span class="comment">  //! the bitmap lines. This array should be used whenever the bitmap</span>
00143 <span class="comment">  //! bits need to be manipulated directly.</span>
00144 <span class="comment"></span>  PLBYTE ** <a class="code" href="classPLBmpBase.html#a15">GetLineArray</a>
00145     () <span class="keyword">const</span>;
00146 <span class="comment"></span>
00147 <span class="comment">  //! Returns pointer to an array containing the starting addresses of</span>
00148 <span class="comment">  //! the bitmap lines. This array should be used whenever the bitmap</span>
00149 <span class="comment">  //! bits need to be manipulated directly.</span>
00150 <span class="comment"></span>  <a class="code" href="classPLPixel32.html">PLPixel32</a> ** <a class="code" href="classPLBmpBase.html#a16">GetLineArray32</a>
00151     () <span class="keyword">const</span>;
00152 <span class="comment"></span>
00153 <span class="comment">  //! Returns pointer to an array containing the starting addresses of</span>
00154 <span class="comment">  //! the bitmap lines. This array should be used whenever the bitmap</span>
00155 <span class="comment">  //! bits need to be manipulated directly.</span>
00156 <span class="comment"></span>  <a class="code" href="classPLPixel24.html">PLPixel24</a> ** <a class="code" href="classPLBmpBase.html#a17">GetLineArray24</a>
00157     () <span class="keyword">const</span>;
00158 <span class="comment"></span>
00159 <span class="comment">  //! Returns pointer to an array containing the starting addresses of</span>
00160 <span class="comment">  //! the bitmap lines. This array should be used whenever the bitmap</span>
00161 <span class="comment">  //! bits need to be manipulated directly.</span>
00162 <span class="comment"></span>  <a class="code" href="classPLPixel16.html">PLPixel16</a> ** <a class="code" href="classPLBmpBase.html#a18">GetLineArray16</a>
00163     () <span class="keyword">const</span>;
00164 <span class="comment"></span>
00165 <span class="comment">  //! Returns true if Bmp and this are almost equal. The comparison is done by </span>
00166 <span class="comment">  //! comparing the pixels in the bitmaps component-wise. If all components are </span>
00167 <span class="comment">  //! closer than epsilon, the bitmaps are considered almost equal.</span>
00168 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classPLBmpBase.html#a19">AlmostEqual</a>
00169     ( <span class="keyword">const</span> <a class="code" href="classPLBmpBase.html">PLBmpBase</a>&amp; Bmp,
00170       <span class="keywordtype">int</span> epsilon
00171     ) <span class="keyword">const</span>;
00172 <span class="comment"></span>
00173 <span class="comment">  //! Sets the bitmap resolution in pixels per inch.</span>
00174 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a20">SetResolution</a> (<span class="keyword">const</span> <a class="code" href="classPLPoint.html">PLPoint</a>&amp; Resolution);
00175 <span class="comment"></span>
00176 <span class="comment">  //! Sets quality of conversion to 8 bpp by CreateCopy(). Valid parameters are</span>
00177 <span class="comment">  //! defined in FilterQuantize.h.</span>
00178 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a21">SetQuantizationMode</a>
00179     ( <span class="keywordtype">int</span> DitherType,
00180       <span class="keywordtype">int</span> DitherPaletteType
00181     );
00182 
00183 <span class="keyword">protected</span>:<span class="comment"></span>
00184 <span class="comment">  //! Can be called from internalCreate() to initialize object state.</span>
00185 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#b0">initLocals</a>
00186     ( PLLONG Width,
00187       PLLONG Height,
00188       <span class="keyword">const</span> PLPixelFormat &amp; pf
00189     );
00190 
00191   <span class="keywordtype">void</span> create8BPPCopy
00192     ( <span class="keyword">const</span> <a class="code" href="classPLBmpBase.html">PLBmpBase</a> &amp; rSrcBmp
00193     );
00194 
00195   <span class="keywordtype">void</span> create1BPPCopy
00196     ( <span class="keyword">const</span> <a class="code" href="classPLBmpBase.html">PLBmpBase</a> &amp; rSrcBmp
00197     );
00198 
00199   <span class="comment">// Member variables</span>
00200   <a class="code" href="classPLPixel32.html">PLPixel32</a> * m_pClrTab;      <span class="comment">// Pointer to the color table.</span>
00201   PLBYTE    ** m_pLineArray;  <span class="comment">// Table of the starting addresses of</span>
00202                               <span class="comment">// the lines.</span>
00203 
00204   <span class="keywordtype">int</span> m_DitherType;
00205   <span class="keywordtype">int</span> m_DitherPaletteType;
00206 };
00207 
00208 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a6">PLBmpBase::SetPaletteEntry</a>
<a name="l00209"></a><a class="code" href="classPLBmpBase.html#a6">00209</a>     ( PLBYTE Entry,
00210       PLBYTE r,
00211       PLBYTE g,
00212       PLBYTE b,
00213       PLBYTE a
00214     )
00215 {
00216   m_pClrTab[Entry].Set (r, g, b, a);
00217 }
00218 
00219 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a6">PLBmpBase::SetPaletteEntry</a>
<a name="l00220"></a><a class="code" href="classPLBmpBase.html#a7">00220</a>     ( PLBYTE Entry,
00221       <a class="code" href="classPLPixel32.html">PLPixel32</a> Value
00222     )
00223 {
00224   m_pClrTab[Entry] = Value;
00225 }
00226 
00227 
<a name="l00228"></a><a class="code" href="classPLBmpBase.html#a11">00228</a> <span class="keyword">inline</span> <a class="code" href="classPLPixel32.html">PLPixel32</a> <a class="code" href="classPLBmpBase.html#a11">PLBmpBase::GetPixel</a> (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)<span class="keyword"> const</span>
00229 <span class="keyword"></span>{
00230   PLASSERT (GetBitsPerPixel() == 32);
00231   <span class="keywordflow">return</span> *((<a class="code" href="classPLPixel32.html">PLPixel32</a> *)<a class="code" href="classPLBmpBase.html#a15">GetLineArray</a>()[y]+x);
00232 }
00233 
<a name="l00234"></a><a class="code" href="classPLBmpBase.html#a10">00234</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a10">PLBmpBase::SetPixel</a> (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="classPLPixel32.html">PLPixel32</a> pixel)
00235 {
00236   PLASSERT (GetBitsPerPixel() == 32);
00237   *(<a class="code" href="classPLBmpBase.html#a16">GetLineArray32</a>()[y]+x) = pixel;
00238 }
00239 
<a name="l00240"></a><a class="code" href="classPLBmpBase.html#a20">00240</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classPLBmpBase.html#a20">PLBmpBase::SetResolution</a>(<span class="keyword">const</span> <a class="code" href="classPLPoint.html">PLPoint</a>&amp; Resolution)
00241 {
00242   PLASSERT_VALID(<span class="keyword">this</span>);
00243   m_Resolution = Resolution;
00244 }
00245 
00246 <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classPLBmpBase.html#a13">PLBmpBase::GetNumColors</a>
<a name="l00247"></a><a class="code" href="classPLBmpBase.html#a13">00247</a>     ()
00248 {
00249   PLASSERT_VALID (<span class="keyword">this</span>);
00250   <span class="keywordflow">return</span> m_pf.GetNumColors();
00251 }
00252 
00253 
00254 <span class="comment">// PLBmpBase direct manipulation</span>
00255 
00256 <span class="keyword">inline</span> PLBYTE ** <a class="code" href="classPLBmpBase.html#a15">PLBmpBase::GetLineArray</a>
<a name="l00257"></a><a class="code" href="classPLBmpBase.html#a15">00257</a>     () <span class="keyword">const</span>
00258 {
00259   PLASSERT (m_pLineArray);
00260   <span class="keywordflow">return</span> m_pLineArray;
00261 }
00262 
00263 <span class="keyword">inline</span> <a class="code" href="classPLPixel32.html">PLPixel32</a> ** <a class="code" href="classPLBmpBase.html#a16">PLBmpBase::GetLineArray32</a>
<a name="l00264"></a><a class="code" href="classPLBmpBase.html#a16">00264</a>     () <span class="keyword">const</span>
00265 {
00266   PLASSERT (m_pLineArray);
00267   PLASSERT (GetBitsPerPixel() == 32);
00268   <span class="keywordflow">return</span> (<a class="code" href="classPLPixel32.html">PLPixel32</a>**)m_pLineArray;
00269 }
00270 
00271 <span class="keyword">inline</span> <a class="code" href="classPLPixel24.html">PLPixel24</a> ** <a class="code" href="classPLBmpBase.html#a17">PLBmpBase::GetLineArray24</a>
<a name="l00272"></a><a class="code" href="classPLBmpBase.html#a17">00272</a>     () <span class="keyword">const</span>
00273 {
00274   PLASSERT (m_pLineArray);
00275   PLASSERT (GetBitsPerPixel() == 24);
00276   <span class="keywordflow">return</span> (<a class="code" href="classPLPixel24.html">PLPixel24</a>**)m_pLineArray;
00277 }
00278 
00279 <span class="keyword">inline</span> <a class="code" href="classPLPixel16.html">PLPixel16</a> ** <a class="code" href="classPLBmpBase.html#a18">PLBmpBase::GetLineArray16</a>
<a name="l00280"></a><a class="code" href="classPLBmpBase.html#a18">00280</a>     () <span class="keyword">const</span>
00281 {
00282   PLASSERT (m_pLineArray);
00283   PLASSERT (GetBitsPerPixel() == 16);
00284   <span class="keywordflow">return</span> (<a class="code" href="classPLPixel16.html">PLPixel16</a>**)m_pLineArray;
00285 }
00286 
00287 <span class="keyword">inline</span> <a class="code" href="classPLPixel32.html">PLPixel32</a> * <a class="code" href="classPLBmpBase.html#a14">PLBmpBase::GetPalette</a>
<a name="l00288"></a><a class="code" href="classPLBmpBase.html#a14">00288</a>     () <span class="keyword">const</span>
00289     <span class="comment">// Returns adress of the color table of the bitmap or NULL if no</span>
00290     <span class="comment">// color table exists.</span>
00291 {
00292   PLASSERT_VALID (<span class="keyword">this</span>);
00293 
00294   <span class="keywordflow">return</span> m_pClrTab;
00295 }
00296 
00297 <span class="preprocessor">#endif</span>
00298 <span class="preprocessor"></span><span class="comment">/*</span>
00299 <span class="comment">/--------------------------------------------------------------------</span>
00300 <span class="comment">|</span>
00301 <span class="comment">|      $Log: plbmpbase_8h-source.html,v $
00301 <span class="comment">|      Revision 1.2  2004/09/15 15:26:29  uzadow
00301 <span class="comment">|      Linux compatibility changes, doc update.
00301 <span class="comment">|</span>
00302 <span class="comment">|      Revision 1.6  2004/09/09 16:52:49  artcom</span>
00303 <span class="comment">|      refactored PixelFormat</span>
00304 <span class="comment">|</span>
00305 <span class="comment">|      Revision 1.5  2004/06/20 16:59:34  uzadow</span>
00306 <span class="comment">|      Added PLBmpBase::CopyPixels() and PLInPlaceFilter</span>
00307 <span class="comment">|</span>
00308 <span class="comment">|      Revision 1.4  2004/06/19 17:34:27  uzadow</span>
00309 <span class="comment">|      Documentation update</span>
00310 <span class="comment">|</span>
00311 <span class="comment">|      Revision 1.3  2004/06/19 16:49:07  uzadow</span>
00312 <span class="comment">|      Changed GetImage so it works with PLBmpBase</span>
00313 <span class="comment">|</span>
00314 <span class="comment">|      Revision 1.2  2004/06/15 14:17:11  uzadow</span>
00315 <span class="comment">|      First working version of PLSubBmp.</span>
00316 <span class="comment">|</span>
00317 <span class="comment">|      Revision 1.1  2004/06/15 10:46:41  uzadow</span>
00318 <span class="comment">|      Initial nonfunctioning version of plbmpbase.</span>
00319 <span class="comment">|</span>
00320 <span class="comment">|</span>
00321 <span class="comment">\--------------------------------------------------------------------</span>
00322 <span class="comment">*/</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Sep 13 16:16:40 2004 for paintlib by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
